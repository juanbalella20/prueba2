<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Impostor - F√∫tbol Argentino</title>
  <style>
    :root{
      --bg:#0b0f14; --card:#121826; --muted:#9aa4b2; --text:#e7eef7;
      --accent:#3b82f6; --danger:#ef4444; --ok:#22c55e; --line:#223046;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:radial-gradient(1200px 600px at 20% 0%, #101a2f 0%, var(--bg) 60%);
      color:var(--text);
    }
    .wrap{max-width:980px;margin:0 auto;padding:24px}
    h1{margin:0 0 8px;font-size:28px}
    p{margin:8px 0;color:var(--muted);line-height:1.4}
    .grid{display:grid;grid-template-columns:1fr;gap:14px}
    @media (min-width:860px){ .grid{grid-template-columns:1.1fr .9fr} }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      border:1px solid var(--line);
      border-radius:16px;
      padding:16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    }
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input, select{
      background:#0f1624;border:1px solid var(--line);color:var(--text);
      padding:10px 12px;border-radius:12px;outline:none;
    }
    input:focus, select:focus{border-color:rgba(59,130,246,0.8)}
    .btn{
      border:1px solid var(--line);
      background:#0f1624;
      color:var(--text);
      padding:10px 14px;
      border-radius:12px;
      cursor:pointer;
      user-select:none;
      transition:transform .04s ease, border-color .2s ease, background .2s ease;
    }
    .btn:hover{border-color:rgba(59,130,246,0.7)}
    .btn:active{transform:scale(0.99)}
    .btn.primary{background:rgba(59,130,246,0.18);border-color:rgba(59,130,246,0.55)}
    .btn.danger{background:rgba(239,68,68,0.15);border-color:rgba(239,68,68,0.55)}
    .btn.ok{background:rgba(34,197,94,0.15);border-color:rgba(34,197,94,0.55)}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:6px 10px;border-radius:999px;border:1px solid var(--line);
      color:var(--muted);font-size:12px;
      background:rgba(255,255,255,0.02);
    }
    .big{
      font-size:26px;font-weight:800;letter-spacing:0.2px;margin:10px 0 0;
    }
    .roleBox{
      margin-top:12px;
      padding:14px;
      border-radius:14px;
      border:1px dashed rgba(154,164,178,0.35);
      background:rgba(0,0,0,0.18);
      min-height:92px;
    }
    .roleTitle{font-size:13px;color:var(--muted);margin:0 0 8px}
    .roleValue{font-size:22px;font-weight:800;margin:0}
    .sub{margin:8px 0 0;color:var(--muted);font-size:13px}
    .hr{height:1px;background:var(--line);margin:14px 0}
    .list{
      margin:10px 0 0;padding:0;list-style:none;
      display:flex;flex-direction:column;gap:8px;
    }
    .li{
      display:flex;justify-content:space-between;align-items:center;
      padding:10px 12px;border-radius:12px;border:1px solid var(--line);
      background:rgba(255,255,255,0.02);
      gap:10px;
    }
    .tag{font-size:12px;color:var(--muted)}
    .small{font-size:12px;color:var(--muted)}
    .hidden{display:none !important}
    .warn{color:#ffd48a}
    .foot{margin-top:14px;color:var(--muted);font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Juego del Impostor ‚Äî F√∫tbol Argentino</h1>
    <p>Roles fijos durante toda la partida. Cada jugador mira su rol en secreto y pasa el dispositivo al siguiente. Al final de cada ronda elimin√°s a uno. Termina cuando quedan 2.</p>

    <div class="grid">
      <!-- IZQUIERDA: flujo principal -->
      <div class="card">
        <div id="screenSetup">
          <div class="row" style="justify-content:space-between">
            <div class="pill">üéÆ Partida</div>
            <div class="pill">üìÑ Sin backend ¬∑ Solo HTML/JS</div>
          </div>

          <div class="hr"></div>

          <div class="row">
            <div style="min-width:220px">
              <label for="numPlayers">Cantidad de jugadores</label>
              <input id="numPlayers" type="number" min="3" max="20" value="6" />
            </div>
            <div style="min-width:220px">
              <label for="numImpostors">Cantidad de impostores</label>
              <input id="numImpostors" type="number" min="1" max="6" value="2" />
            </div>
          </div>

          <p class="small">Regla: impostores &lt; jugadores. Recomendado: 1‚Äì3 impostores seg√∫n el tama√±o.</p>
          <p id="setupError" class="small warn hidden"></p>

          <div class="row" style="margin-top:10px">
            <button class="btn primary" id="btnStart">Crear partida</button>
            <button class="btn" id="btnResetAll">Reiniciar todo</button>
          </div>

          <p class="foot">Consejo cl√°sico: pasen el tel√©fono mirando para abajo y tapen la pantalla cuando cambian de jugador.</p>
        </div>

        <div id="screenReveal" class="hidden">
          <div class="row" style="justify-content:space-between;align-items:flex-start">
            <div>
              <div class="pill">üë§ Turno de <b id="whoTurn"></b></div>
              <p class="sub" id="turnHint">Toc√° ‚ÄúVer mi rol‚Äù (y que nadie mire).</p>
            </div>
            <div class="pill">üîí Secreto</div>
          </div>

          <div class="roleBox" id="roleBox">
            <p class="roleTitle">Tu rol</p>
            <p class="roleValue" id="roleValue">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</p>
            <p class="sub" id="roleSub">Todav√≠a no revelado</p>
          </div>

          <div class="row" style="margin-top:12px">
            <button class="btn ok" id="btnReveal">Ver mi rol</button>
            <button class="btn primary" id="btnNextPlayer">Pasar al siguiente</button>
          </div>

          <p class="small" id="revealNote">Importante: cuando veas tu rol, volv√© a tapar la pantalla antes de pasar.</p>
        </div>

        <div id="screenRounds" class="hidden">
          <div class="row" style="justify-content:space-between">
            <div class="pill">üïπÔ∏è Ronda <b id="roundNum"></b></div>
            <div class="pill">üë• Vivos: <b id="aliveCount"></b></div>
          </div>

          <div class="hr"></div>

          <p class="sub">Al final de cada ronda, eleg√≠ a qui√©n eliminan (selecci√≥n del usuario).</p>

          <div class="row" style="margin-top:10px">
            <div style="min-width:260px;flex:1">
              <label for="elimSelect">Eliminar jugador</label>
              <select id="elimSelect"></select>
            </div>
            <button class="btn danger" id="btnEliminate">Eliminar</button>
          </div>

          <p id="elimMsg" class="small"></p>

          <div class="hr"></div>

          <div id="endBlock" class="hidden">
            <p class="big">Fin de la partida</p>
            <p class="sub">Quedaron 2 jugadores. Si quer√©s, pod√©s revelar los roles finales.</p>
            <div class="row" style="margin-top:10px">
              <button class="btn ok" id="btnRevealAll">Revelar roles</button>
              <button class="btn" id="btnNewGame">Nueva partida</button>
            </div>
          </div>

          <div id="continueBlock" class="hidden">
            <p class="sub">¬øSe termin√≥ la ronda o seguimos?</p>
            <div class="row" style="margin-top:10px">
              <button class="btn primary" id="btnNextRound">Seguimos (nueva ronda)</button>
              <button class="btn" id="btnStopNow">Terminar ahora</button>
            </div>
          </div>

          <div id="rolesList" class="hidden" style="margin-top:12px"></div>
        </div>
      </div>

      <!-- DERECHA: estado de la partida -->
      <div class="card">
        <div class="row" style="justify-content:space-between">
          <div class="pill">üìå Estado</div>
          <div class="pill" id="phasePill">Fase: Configuraci√≥n</div>
        </div>

        <div class="hr"></div>

        <p class="small"><b>Jugadores vivos</b></p>
        <ul class="list" id="aliveList"></ul>

        <div class="hr"></div>

        <p class="small"><b>Eliminados</b></p>
        <ul class="list" id="deadList"></ul>

        <p class="foot">Roles asignados una sola vez y se mantienen toda la partida (tal como pediste).</p>
      </div>
    </div>
  </div>

  <script>
    // Lista de futbolistas argentinos famosos (para asignar a NO impostores).
    // Pod√©s editar/expandir esta lista cuando quieras.
    const ARG_PLAYERS = [
      "Lionel Messi","Diego Maradona","Alfredo Di St√©fano","Gabriel Batistuta","Juan Rom√°n Riquelme",
      "Ariel Ortega","Javier Zanetti","Sergio Ag√ºero","√Ångel Di Mar√≠a","Carlos Tevez",
      "Juli√°n √Ålvarez","Enzo Fern√°ndez","Alexis Mac Allister","Emiliano Mart√≠nez","Mario Kempes",
      "Daniel Passarella","Osvaldo Ardiles","Claudio Caniggia","Hern√°n Crespo","Walter Samuel",
      "Javier Mascherano","Fernando Redondo","Pablo Aimar","Esteban Cambiasso","Gonzalo Higua√≠n",
      "Rodrigo De Paul","Lautaro Mart√≠nez","Nicol√°s Otamendi","Juan Pablo Sor√≠n","Roberto Ayala",
      "Mart√≠n Palermo","Carlos Bilardo","C√©sar Luis Menotti","Ricardo Bochini","Ubaldo Fillol",
      "Daniel Alberto Bertoni","Ren√© Houseman","Jorge Valdano","Sergio Goycochea","Cuti Romero"
    ];

    // Estado global de la partida
    const state = {
      phase: "setup", // setup | reveal | rounds | end
      numPlayers: 0,
      numImpostors: 0,
      assignments: [], // {id, name, roleType: 'impostor'|'player', roleValue, alive}
      revealIndex: 0,
      round: 1,
      revealedThisTurn: false
    };

    // Helpers
    function $(id){ return document.getElementById(id); }
    function shuffle(arr){
      const a = arr.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]]=[a[j],a[i]];
      }
      return a;
    }
    function setPhase(phase){
      state.phase = phase;
      $("screenSetup").classList.toggle("hidden", phase !== "setup");
      $("screenReveal").classList.toggle("hidden", phase !== "reveal");
      $("screenRounds").classList.toggle("hidden", !(phase === "rounds" || phase === "end"));
      $("phasePill").textContent = "Fase: " + (
        phase==="setup" ? "Configuraci√≥n" :
        phase==="reveal" ? "Revelar roles" :
        phase==="rounds" ? "Rondas" : "Final"
      );
    }

    function renderLists(){
      const alive = state.assignments.filter(p => p.alive);
      const dead  = state.assignments.filter(p => !p.alive);

      $("aliveList").innerHTML = alive.length
        ? alive.map(p => `<li class="li"><span><b>${p.name}</b></span><span class="tag">#${p.id}</span></li>`).join("")
        : `<li class="li"><span class="tag">‚Äî</span></li>`;

      $("deadList").innerHTML = dead.length
        ? dead.map(p => `<li class="li"><span>${p.name}</span><span class="tag">‚úñ</span></li>`).join("")
        : `<li class="li"><span class="tag">‚Äî</span></li>`;
    }

    function renderRevealScreen(){
      const current = state.assignments[state.revealIndex];
      $("whoTurn").textContent = current.name;
      $("roleValue").textContent = "‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢";
      $("roleSub").textContent = "Todav√≠a no revelado";
      state.revealedThisTurn = false;
    }

    function renderRoundsScreen(){
      const alive = state.assignments.filter(p => p.alive);
      $("roundNum").textContent = String(state.round);
      $("aliveCount").textContent = String(alive.length);

      // select de eliminaci√≥n
      $("elimSelect").innerHTML = alive.map(p => `<option value="${p.id}">${p.name}</option>`).join("");

      // bloques
      $("endBlock").classList.add("hidden");
      $("continueBlock").classList.add("hidden");
      $("rolesList").classList.add("hidden");
      $("elimMsg").textContent = "";
    }

    function validateSetup(nPlayers, nImpostors){
      if (!Number.isFinite(nPlayers) || !Number.isFinite(nImpostors)) return "Valores inv√°lidos.";
      if (nPlayers < 3) return "M√≠nimo 3 jugadores.";
      if (nPlayers > 20) return "M√°ximo 20 jugadores (para mantenerlo manejable).";
      if (nImpostors < 1) return "Debe haber al menos 1 impostor.";
      if (nImpostors >= nPlayers) return "Los impostores deben ser menos que la cantidad de jugadores.";
      if (nPlayers - nImpostors > ARG_PLAYERS.length) return "No alcanza la lista de jugadores famosos para tantos NO impostores.";
      return "";
    }

    function createGame(nPlayers, nImpostors){
      state.numPlayers = nPlayers;
      state.numImpostors = nImpostors;
      state.round = 1;
      state.revealIndex = 0;

      // Generar nombres de participantes (Jugador 1..N)
      const participants = Array.from({length:nPlayers}, (_,i)=>({
        id: i+1,
        name: `Jugador ${i+1}`
      }));

      // Elegir qu√© ids son impostores
      const ids = shuffle(participants.map(p=>p.id));
      const impostorIds = new Set(ids.slice(0, nImpostors));

      // Elegir futbolistas para los no impostores
      const neededPlayers = nPlayers - nImpostors;
      const chosenFootballers = shuffle(ARG_PLAYERS).slice(0, neededPlayers);
      let idx = 0;

      state.assignments = participants.map(p=>{
        const isImp = impostorIds.has(p.id);
        return {
          id: p.id,
          name: p.name,
          roleType: isImp ? "impostor" : "player",
          roleValue: isImp ? "IMPOSTOR" : chosenFootballers[idx++],
          alive: true
        };
      });

      renderLists();
      setPhase("reveal");
      renderRevealScreen();
    }

    function revealRole(){
      const current = state.assignments[state.revealIndex];
      state.revealedThisTurn = true;

      if (current.roleType === "impostor"){
        $("roleValue").textContent = "IMPOSTOR";
        $("roleValue").style.color = "var(--danger)";
        $("roleSub").textContent = "Tu objetivo: pasar desapercibido.";
      } else {
        $("roleValue").textContent = current.roleValue;
        $("roleValue").style.color = "var(--accent)";
        $("roleSub").textContent = "Sos jugador (no impostor).";
      }
    }

    function nextPlayer(){
      if (!state.revealedThisTurn){
        // Cl√°sico: obligar a revelar antes de pasar
        $("roleSub").textContent = "Primero toc√° ‚ÄúVer mi rol‚Äù.";
        return;
      }

      state.revealIndex += 1;

      if (state.revealIndex >= state.assignments.length){
        // Terminar revelaci√≥n y pasar a rondas
        setPhase("rounds");
        renderRoundsScreen();
        renderLists();
        return;
      }

      renderRevealScreen();
    }

    function eliminateSelected(){
      const alive = state.assignments.filter(p=>p.alive);
      if (alive.length <= 2){
        // Ya termin√≥
        endGame();
        return;
      }

      const id = Number($("elimSelect").value);
      const target = state.assignments.find(p => p.id === id && p.alive);
      if (!target) return;

      target.alive = false;
      renderLists();

      const aliveAfter = state.assignments.filter(p=>p.alive);
      $("elimMsg").textContent = `Eliminaste a ${target.name}. Quedan ${aliveAfter.length} jugadores vivos.`;

      if (aliveAfter.length <= 2){
        endGame();
      } else {
        // Preguntar si seguimos o terminamos (como pediste)
        $("continueBlock").classList.remove("hidden");
      }
    }

    function nextRound(){
      state.round += 1;
      renderRoundsScreen();
      renderLists();
    }

    function stopNow(){
      // Termina por decisi√≥n del usuario (aunque queden m√°s de 2)
      endGame(true);
    }

    function endGame(userStopped=false){
      setPhase("end");
      renderLists();

      $("endBlock").classList.remove("hidden");
      $("continueBlock").classList.add("hidden");

      const alive = state.assignments.filter(p=>p.alive);
      if (userStopped){
        $("endBlock").querySelector(".sub").textContent =
          `Terminaste la partida manualmente. Vivos: ${alive.map(p=>p.name).join(", ")}. Pod√©s revelar roles si quer√©s.`;
      } else {
        $("endBlock").querySelector(".sub").textContent =
          `Quedaron 2 jugadores: ${alive.map(p=>p.name).join(" y ")}. Pod√©s revelar roles finales.`;
      }
    }

    function revealAllRoles(){
      const rows = state.assignments.map(p=>{
        const status = p.alive ? "VIVO" : "ELIMINADO";
        const badgeColor = p.alive ? "rgba(34,197,94,0.15)" : "rgba(239,68,68,0.12)";
        const border = p.alive ? "rgba(34,197,94,0.45)" : "rgba(239,68,68,0.45)";
        const role = p.roleType === "impostor" ? "IMPOSTOR" : p.roleValue;
        const roleTag = p.roleType === "impostor" ? "var(--danger)" : "var(--accent)";
        return `
          <div class="li" style="border-color:${border};background:${badgeColor}">
            <div>
              <div><b>${p.name}</b> <span class="tag">(${status})</span></div>
              <div class="small">Rol: <b style="color:${roleTag}">${role}</b></div>
            </div>
            <div class="tag">#${p.id}</div>
          </div>
        `;
      }).join("");

      $("rolesList").innerHTML = `<div class="row" style="justify-content:space-between;align-items:center">
        <div class="pill">üßæ Roles</div><div class="pill">Final</div>
      </div><div style="height:10px"></div>${rows}`;

      $("rolesList").classList.remove("hidden");
    }

    function resetAll(){
      state.phase = "setup";
      state.numPlayers = 0;
      state.numImpostors = 0;
      state.assignments = [];
      state.revealIndex = 0;
      state.round = 1;
      state.revealedThisTurn = false;

      $("setupError").classList.add("hidden");
      $("setupError").textContent = "";
      $("elimMsg").textContent = "";
      $("rolesList").classList.add("hidden");
      $("aliveList").innerHTML = `<li class="li"><span class="tag">‚Äî</span></li>`;
      $("deadList").innerHTML  = `<li class="li"><span class="tag">‚Äî</span></li>`;
      setPhase("setup");
    }

    // Eventos UI
    $("btnStart").addEventListener("click", ()=>{
      const nPlayers = Number($("numPlayers").value);
      const nImpostors = Number($("numImpostors").value);

      const err = validateSetup(nPlayers, nImpostors);
      if (err){
        $("setupError").textContent = err;
        $("setupError").classList.remove("hidden");
        return;
      }
      $("setupError").classList.add("hidden");
      createGame(nPlayers, nImpostors);
    });

    $("btnResetAll").addEventListener("click", resetAll);
    $("btnReveal").addEventListener("click", revealRole);
    $("btnNextPlayer").addEventListener("click", nextPlayer);

    $("btnEliminate").addEventListener("click", eliminateSelected);
    $("btnNextRound").addEventListener("click", nextRound);
    $("btnStopNow").addEventListener("click", stopNow);

    $("btnRevealAll").addEventListener("click", revealAllRoles);
    $("btnNewGame").addEventListener("click", resetAll);

    // Inicio
    resetAll();
  </script>
</body>
</html>
